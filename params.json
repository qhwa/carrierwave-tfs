{"note":"Don't delete this file! It's used internally to help with page regeneration.","tagline":"Taobao TFS uploader with CarrierWave for Ruby Application","name":"carrierwave-tfs","body":"# CarrierWave for TFS\r\n\r\nThis gem adds support for Taobao [TFS](http://code.taobao.org/project/view/366/) to [CarrierWave](https://github.com/jnicklas/carrierwave/)\r\n\r\n## Installation\r\n\r\n```ruby\r\ngem install carrierwave-tfs\r\n```\r\n\r\n## Using Bundler\r\n\r\n```ruby\r\ngem 'rtfs'\r\ngem 'carrierwave-tfs'\r\n```\r\n\r\n## Configuration\r\n\r\n创建 `config/initializes/carrierwave.rb`\r\n\r\n\r\n```ruby\r\nCarrierWave.configure do |config|\r\n  config.storage = :tfs\r\n\r\n  # == Begin 下面有两种配置方式，（TFS 客户端 或 WebService)\r\n      \r\n  # 客户端\r\n  config.tfs_ns_addr = \"127.0.0.1:27017\"\r\n  config.tfs_tool_path = \"/usr/bin/tfstool\"\r\n\r\n  # WebService\r\n  config.tfs_ns_addr = \"http://127.0.0.1:3900\"\r\n  config.tfs_web_service_app_key = \"Kshj*&2kj1\"\r\n\r\n  # 二级目录\r\n  config.tfs_bucket = \"tfscom\"\r\n  # TFS bin 文件地址, 默认 /home/admin/tfs/bin/tfstool\r\n      \r\n  # 域名\r\n  config.tfs_cdn_domains = [\"img01.tfscdn.com\",\"img02.tfscdn.com\"]\r\nend\r\n```\r\n\r\n上面的配置返回的地址格式将会是这样: `http://img01.tfscdn.com/tfscom/d5b5c2c676e59eb005436cd50eecce8dd4635066.jpg`\r\n\r\n\r\n## 关于 Model 里面\r\n\r\n```ruby\r\nclass AvatarUploader < CarrierWave::Uploader::Base\r\n  include CarrierWave::MiniMagick\r\n\r\n  version :normal do\r\n    process :resize_to_fill => [48, 48]\r\n  end\r\n  \r\n  version :small do\r\n    process :resize_to_fill => [16, 15]\r\n  end\r\nend\r\n\r\nclass User\r\n  include Mongoid::Document\r\n  \r\n  # 需要单独定义几个字段用来存放文件地址，字段个数与 Uploader 的 version 对应,因为 TFS 每个文件名是不同的\r\n  field :avatar_file_name\r\n  field :avatar_normal_file_name\r\n  field :avatar_small_file_name\r\n  \r\n  mount_uploader :avatar, AvatarUploader\r\nend\r\n```","google":"UA-9745660-1"}